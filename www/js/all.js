var Joystick={yaw:0,pitch:0,roll:0,throttle:0,init:function(){interact(".pad").draggable({onmove:Joystick.dragMoveListener,onend:Joystick.autoReturn}),$(".button").click(function(){navigator.vibrate(50)}),$("#autoreturn").click(function(){$("#autoreturn:checked").length&&(Joystick.animateToPosition("#rjoystick .pad",0,0),Joystick.animateToPosition("#ljoystick .pad",0,$("#ljoystick .pad").attr("data-y")))})},autoReturn:function(t){if(0==$("#autoreturn:checked").length)return!1;var a=t.target,i=$(a).parent();if("rjoystick"==i.attr("id"))var r=0,e=0;else{if("ljoystick"!=i.attr("id"))return!1;var r=0,e=a.getAttribute("data-y")}Joystick.animateToPosition(a,r,e)},animateToPosition:function(t,a,i){$(t).addClass("transition").css("transform","translate("+a+"px, "+i+"px)").attr("data-x",a).attr("data-y",i),setTimeout(function(){$(t).removeClass("transition")},250)},dragMoveListener:function(t){var a=t.target;if(!Joystick.isInsideCircle($(a).position().left,-$(a).position().top)){var i=Joystick.getClosestInnerPoint($(a).position().left,-$(a).position().top);if("ljoystick"==$(a).parent().attr("id"))var r=-i[1]-200;else var r=-i[1]-100;a.setAttribute("data-x",i[0]-100),a.setAttribute("data-y",r)}var e=(parseFloat(a.getAttribute("data-x"))||0)+t.dx,o=(parseFloat(a.getAttribute("data-y"))||0)+t.dy;a.style.webkitTransform=a.style.transform="translate("+e+"px, "+o+"px)",a.setAttribute("data-x",e),a.setAttribute("data-y",o)},isInsideCircle:function(t,a){var i=!1,r=200,e=r/2,o=r/2,n=-r/2,s=Math.pow(t-o,2)+Math.pow(a-n,2),c=Math.pow(e,2);return c>=s&&(i=!0),i},updateYawThrottle:function(t,a){},updatePitchRoll:function(t,a){},getClosestInnerPoint:function(t,a){var i=100,r=-100,e=100;if(t==i)var o=0;else var o=(a-r)/(t-i);var n=a-o*t,s=1+Math.pow(o,2),c=-2*i+2*o*(n-r),u=Math.pow(n-r,2)-Math.pow(e,2)+Math.pow(i,2),l=Math.pow(c,2)-4*s*u;if(0>l){var d=t;if(console.log(a),a>=0)var p=0;else var p=-2*e}else{var v=(-1*c-Math.sqrt(l))/(2*s),f=(-1*c+Math.sqrt(l))/(2*s);if(Math.abs(t-v)<Math.abs(t-f))var d=Math.trunc(v),p=Math.trunc(o*v+n);else var d=Math.trunc(f),p=Math.trunc(o*f+n)}return[d,p]}};