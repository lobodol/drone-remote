var Joystick={yaw:0,pitch:0,roll:0,throttle:0,init:function(){interact(".pad").draggable({onmove:Joystick.dragMoveListener,onend:Joystick.autoReturn}),$(".button").click(function(){navigator.vibrate(50)}),$("#autoreturn").click(function(){$("#autoreturn:checked").length&&(Joystick.animateToPosition("#rjoystick .pad",0,0),Joystick.animateToPosition("#ljoystick .pad",0,$("#ljoystick .pad").attr("data-y")))})},autoReturn:function(t){if(0==$("#autoreturn:checked").length)return!1;var a=t.target,i=$(a).parent();if("rjoystick"==i.attr("id"))var o=0,r=0;else{if("ljoystick"!=i.attr("id"))return!1;var o=0,r=a.getAttribute("data-y")}Joystick.animateToPosition(a,o,r)},animateToPosition:function(t,a,i){$(t).addClass("transition").css("transform","translate("+a+"px, "+i+"px)").attr("data-x",a).attr("data-y",i),setTimeout(function(){$(t).removeClass("transition")},250)},dragMoveListener:function(t){var a=t.target;if(!Joystick.isInsideCircle($(a).position().left,-$(a).position().top)){var i=Joystick.getClosestInnerPoint($(a).position().left,-$(a).position().top);if("ljoystick"==$(a).parent().attr("id"))var o=-i[1]-200;else var o=-i[1]-100;a.setAttribute("data-x",i[0]-100),a.setAttribute("data-y",o)}var r=(parseFloat(a.getAttribute("data-x"))||0)+t.dx,e=(parseFloat(a.getAttribute("data-y"))||0)+t.dy;a.style.webkitTransform=a.style.transform="translate("+r+"px, "+e+"px)",a.setAttribute("data-x",r),a.setAttribute("data-y",e)},isInsideCircle:function(t,a){var i=!1,o=200,r=o/2,e=o/2,n=-o/2,s=Math.pow(t-e,2)+Math.pow(a-n,2),c=Math.pow(r,2);return c>=s&&(i=!0),i},updateYawThrottle:function(t,a){},updatePitchRoll:function(t,a){},getClosestInnerPoint:function(t,a){var i=100,o=-100,r=100,e=(a-o)/(t-i),n=a-e*t,s=1+Math.pow(e,2),c=-2*i+2*e*(n-o),u=Math.pow(n-o,2)-Math.pow(r,2)+Math.pow(i,2),l=Math.pow(c,2)-4*s*u,d=(-1*c-Math.sqrt(l))/(2*s),p=(-1*c+Math.sqrt(l))/(2*s);if(Math.abs(t-d)<Math.abs(t-p))var h=Math.trunc(d),y=Math.trunc(e*d+n);else var h=Math.trunc(p),y=Math.trunc(e*p+n);return[h,y]}};