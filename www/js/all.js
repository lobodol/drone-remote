function successFunction(){console.info("It worked!")}function errorFunction(t){console.error(t)}function trace(t){console.log(t)}var app={initialize:function(){document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){var t=(document.getElementById("pot"),document.getElementById("delta")),e=document.getElementById("on"),n=document.getElementById("off"),r=!1,i="",o=new Date,a=function(t){alert("Error: "+t)};serial.requestPermission({vid:"2a03",pid:"0043"},function(e){serial.open({baudRate:9600},function(e){r=!0,serial.registerReadCallback(function(e){var n=new Uint8Array(e);if(n.length>=1)for(var r=0;r<n.length;r++)if(13==n[r]){var a=new Date;t.innerText=a-o,o=a;var s=parseInt(i);pot.innerText=s,i=""}else{var c=String.fromCharCode(n[r]),u=escape(c);i+=unescape(u)}},a)},a)},a),e.onclick=function(){r&&serial.write("1")},n.onclick=function(){r&&serial.write("0")}}};app.initialize(),AndroidFullScreen.isSupported(),AndroidFullScreen.isImmersiveModeSupported(successFunction,errorFunction),AndroidFullScreen.immersiveWidth(trace,errorFunction),AndroidFullScreen.immersiveHeight(trace,errorFunction),AndroidFullScreen.leanMode(successFunction,errorFunction),AndroidFullScreen.showSystemUI(successFunction,errorFunction),AndroidFullScreen.showUnderStatusBar(successFunction,errorFunction),AndroidFullScreen.showUnderSystemUI(successFunction,errorFunction),AndroidFullScreen.immersiveMode(successFunction,errorFunction);var Joystick={yaw:0,pitch:0,roll:0,throttle:0,init:function(){interact(".pad").draggable({onmove:Joystick.dragMoveListener,onend:Joystick.autoReturn}),$(".button").click(function(){navigator.vibrate(50)}),$("#autoreturn").click(function(){$("#autoreturn:checked").length&&(Joystick.animateToPosition("#rjoystick .pad",0,0),Joystick.animateToPosition("#ljoystick .pad",0,$("#ljoystick .pad").attr("data-y")))})},autoReturn:function(t){if(0==$("#autoreturn:checked").length)return!1;var e=t.target,n=$(e).parent();if("rjoystick"==n.attr("id"))var r=0,i=0;else{if("ljoystick"!=n.attr("id"))return!1;var r=0,i=e.getAttribute("data-y")}Joystick.animateToPosition(e,r,i),"ljoystick"==$(e).parent().attr("id")?Joystick.updateYawThrottle(r,i):Joystick.updatePitchRoll(r,i)},animateToPosition:function(t,e,n){$(t).addClass("transition").css("transform","translate("+e+"px, "+n+"px)").attr("data-x",e).attr("data-y",n),setTimeout(function(){$(t).removeClass("transition")},250)},dragMoveListener:function(t){var e=t.target;if(!Joystick.isInsideCircle($(e).position().left,-$(e).position().top)){var n=Joystick.getClosestInnerPoint($(e).position().left,-$(e).position().top);if("ljoystick"==$(e).parent().attr("id"))var r=-n[1]-200;else var r=-n[1]-100;e.setAttribute("data-x",n[0]-100),e.setAttribute("data-y",r)}var i=(parseFloat(e.getAttribute("data-x"))||0)+t.dx,o=(parseFloat(e.getAttribute("data-y"))||0)+t.dy;e.style.webkitTransform=e.style.transform="translate("+i+"px, "+o+"px)",e.setAttribute("data-x",i),e.setAttribute("data-y",o),"ljoystick"==$(e).parent().attr("id")?Joystick.updateYawThrottle(i,o):Joystick.updatePitchRoll(i,o)},isInsideCircle:function(t,e){var n=!1,r=200,i=r/2,o=r/2,a=-r/2,s=Math.pow(t-o,2)+Math.pow(e-a,2),c=Math.pow(i,2);return c>=s&&(n=!0),n},updateYawThrottle:function(t,e){e>0?e=0:-200>e&&(e=-200),t>100?t=100:-100>t&&(t=-100),Joystick.yaw=parseInt(1.8*(t+100)),Joystick.throttle=parseInt(-1*e/2)},updatePitchRoll:function(t,e){-100>t?t=-100:t>100&&(t=100),-100>e?e=-100:e>100&&(e=100),Joystick.roll=parseInt(4.5*(t+100)),Joystick.pitch=parseInt(4.5*(e+100))},getClosestInnerPoint:function(t,e){var n=100,r=-100,i=100;if(t==n)var o=0;else var o=(e-r)/(t-n);var a=e-o*t,s=1+Math.pow(o,2),c=-2*n+2*o*(a-r),u=Math.pow(a-r,2)-Math.pow(i,2)+Math.pow(n,2),l=Math.pow(c,2)-4*s*u;if(0>l){var d=t;if(e>=0)var p=0;else var p=-2*i}else{var y=(-1*c-Math.sqrt(l))/(2*s),f=(-1*c+Math.sqrt(l))/(2*s);if(Math.abs(t-y)<Math.abs(t-f))var d=Math.trunc(y),p=Math.trunc(o*y+a);else var d=Math.trunc(f),p=Math.trunc(o*f+a)}return[d,p]}};